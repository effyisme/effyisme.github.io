<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anxiety Defusal App</title>
  <style>
    :root {
      --bg-color: #F5F5DC;
      --text-color: #5D4037;
      --primary-color: #A1887F;
      --secondary-color: #D7CCC8;
      --accent-color: #8D6E63;
      --white: #FFFFFF;
      --shadow: rgba(0, 0, 0, 0.08);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
    }
    nav {
      display: flex;
      background-color: var(--secondary-color);
      border-bottom: 2px solid var(--primary-color);
    }
    nav button.tab-btn {
      flex: 1;
      padding: 1rem 0;
      background: none;
      border: none;
      font-weight: bold;
      color: var(--text-color);
      cursor: pointer;
      transition: background-color 0.3s;
      border-bottom: 3px solid transparent;
    }
    nav button.tab-btn.active {
      background-color: var(--primary-color);
      color: var(--white);
      border-bottom-color: var(--accent-color);
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 1rem;
    }
    .pane { display: none; }
    .pane.active { display: block; animation: fadeIn 0.4s ease-in; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    h1 {
      text-align: center;
      color: var(--accent-color);
      margin-bottom: 1rem;
    }
    .subtle { text-align: center; color: var(--accent-color); font-style: italic; margin-bottom: 1.5rem; }
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 12px var(--shadow);
      border-left: 5px solid var(--primary-color);
    }
    button.collapsible {
      width: 100%;
      background: var(--white);
      border: none;
      padding: 1rem;
      text-align: left;
      font-weight: bold;
      font-size: 1rem;
      border-radius: 8px;
      margin-bottom: 0.75rem;
      position: relative;
      box-shadow: 0 2px 6px var(--shadow);
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button.collapsible:after {
      content: '▼';
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      transition: transform 0.3s;
      color: var(--primary-color);
    }
    button.collapsible.active:after { transform: translateY(-50%) rotate(180deg); }
    button.collapsible:hover { background-color: var(--secondary-color); }
    .collapsible-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
      margin-bottom: 1rem;
    }
    .collapsible-content div {
      padding: 0.75rem;
      background: rgba(255,255,255,0.8);
      border-radius: 8px;
    }
    .question-card, .reframe-card {
      background: var(--white);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 12px var(--shadow);
    }
    textarea {
      width: 100%;
      border: 2px solid var(--secondary-color);
      border-radius: 8px;
      padding: 0.75rem;
      margin: 0.5rem 0 1rem;
      font-family: inherit;
      font-size: 1rem;
      resize: vertical;
    }
    .btn {
      width: 100%;
      padding: 0.75rem;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      background-color: var(--primary-color);
      color: var(--white);
      transition: background-color 0.3s;
    }
    .btn:hover { background-color: var(--accent-color); }
    .step-indicator { display: block; font-weight: bold; color: var(--accent-color); margin-bottom: 0.5rem; }
    ol, ul { margin-left: 1.2rem; margin-bottom: 1rem; }

    #level-buttons {
  display: flex;
  justify-content: space-between;
  margin: 1rem 0;
}
.level-btn {
  flex: 1;
  margin: 0 0.25rem;
  padding: 0.75rem;
  border: 2px solid var(--primary-color);
  background: var(--white);
  color: var(--primary-color);
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: background-color 0.3s, color 0.3s;
}
.level-btn.active,
.level-btn:hover {
  background: var(--primary-color);
  color: var(--white);
}
#shuffle-btn {
  margin-top: 0.5rem;
}
#challenge-display p.challenge-text {
  font-size: 1.25rem;
  font-weight: bold;
  margin: 1rem 0 0.5rem;
  color: var(--text-color);
}
#challenge-display p.reminder {
  font-size: 1rem;
  font-style: italic;
  color: var(--accent-color);
  margin-bottom: 1rem;
}
#challenge-display span.congrats {
  display: block;
  font-size: 0.9rem;
  color: var(--primary-color);
  margin-bottom: 0.5rem;
}

@keyframes pop {
  0%   { transform: scale(0.8); opacity: 0; }
  100% { transform: scale(1);   opacity: 1; }
}
.challenge-result {
  background: var(--white);
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  text-align: center;
  animation: pop 0.4s ease-out;
}
.challenge-result .celebration {
  font-size: 1.4rem;
  color: var(--primary-color);
  margin-bottom: 0.5rem;
}
.challenge-result .reminder {
  margin-top: 1rem;
  font-style: italic;
  color: var(--accent-color);
}

#view-all-toggle {
  margin-right: 0.5rem;
}
#all-challenges-list li,
#recent-challenges li {
  margin-bottom: 0.25rem;
}


  </style>
</head>
<body>
  <nav>
    <button class="tab-btn active" data-target="tab1">Self-Scan</button>
    <button class="tab-btn" data-target="tab2">In-the-Moment</button>
    <button class="tab-btn" data-target="tab3">Affirmations</button>
    <button class="tab-btn" data-target="tab4">Challenge</button>
  </nav>
  <div class="container">
    <div id="tab1" class="pane active">
      <h1>Safe Zone Self-Inquiry</h1>
      <p class="subtle">When you feel discomfort, take a quiet moment. Ask each in order to build clarity.</p>
      <div id="scan-flow-container"></div>
    </div>
    <div id="tab2" class="pane">
      <h1>C.A.R.E. Protocol</h1>
      <p class="subtle">A step-by-step guide when panic strikes.</p>
      <div class="card">
        <strong>C – CALM the Body First</strong>
        <button class="collapsible">Drop everything you are doing now</button>
        <div class="collapsible-content"><div>
          <ol>
            <li>Go to a restroom and splash cold water on your face and wrists.</li>
            <li>Pop a sour candy or a piece of strong mint gum in your mouth.</li>
            <li>Tense every muscle in your body—clench your fists, curl your toes, squeeze your shoulders—for 5 seconds as hard as you can. Then, release everything at once.</li>
            <li>Deep inhale and exhale for 1 minute</li>
          </ol>
        </div></div>
        <button class="collapsible">5-4-3-2-1 Grounding</button>
        <div class="collapsible-content"><div>
          <ol>
            <li>5 things you SEE</li>
            <li>4 things you FEEL</li>
            <li>3 things you HEAR</li>
            <li>2 things you SMELL</li>
            <li>1 thing you TASTE</li>
          </ol>
        </div></div>
      </div>
      <div class="card">
        <strong>A – ACKNOWLEDGE the Fear</strong>
        <p><em>"Hello, anxiety. I see you. I know you're here because you're trying to protect me. You're scared that I'm boring, or that people will judge me. Thank you for trying to keep me safe. I am allowed to feel this way. I don't have to fight it.</em></p>
    <p> You are not the anxiety. You are the one who is noticing the anxiety. </p>  
        <p>Narrate what's happening in your head as if you were a neutral documentary filmmaker. Instead of "I'm so awkward," think: "Ah, there is the feeling of awkwardness."</p>
</div>
      <div class="card">
        <strong>R – RESPOND with Truths</strong>
        <button class="collapsible">Counter</button>
        <div class="collapsible-content"><div><em>This is just anxiety. It feels awful, but it is not dangerous, and it will pass.
            I can handle this feeling. It's really uncomfortable, but not dangerous.
        </em></div></div>
        
        <button class="collapsible">Evidence</button>
        <div class="collapsible-content">
            <div>
                <b><em>What is the hard evidence that this thought is 100% true?</em></b>
                <p>Feelings: I feel like I'll make a fool of myself</p>
                <p>Evidence: Three people pointed and laughed</p>
                <b><em>What is the evidence that this thought is not true, or is at least an exaggeration?</em></b>
                <p>Feelings: I feel like I'll make a fool of myself</p>
                <p>Most people in the meeting are focused on their own work, not on me.</p>
                <p>I've been in dozens of meetings and nobody have never complaint about me.</p>
            </div>
        </div>
        <button class="collapsible">Alternative explanations</button>
        <div class="collapsible-content">
            <div>
                <b><em> What are at least ONE, more probable explanations for this situation?</em></b>
                <p>Feelings: They are mad at me.</p>
                <p>Alternative explanations:</p>
                <ul>
                   
                <li>They were lost in thought about a deadline and didn't even see me.</li>
                    <li>They are having a bad day and weren't in the mood to talk.</li>
                    <li>They were rushing to the restroom.</li></ul>
                <p>The key is to sympathize with them. And try to assume the best of everyone.</p>
            </div>
        </div>
        <button class="collapsible">So what</button>
        <div class="collapsible-content">
            <div>
                <b><em>Okay, let's say the worst happens. I do [action]. So what? What will actually, tangibly happen next?</em></b>
                <p>Anxiety says: "It will be a disaster!"</p>
                <p>So what? What's the worst could happen?</p>
                <p>So what? How much will this specific moment matter in 5 minutes? In 5 hours? In 5 days?</p>
                <p>So what? Can you survive this? I believed you survive something like this before.</p>
                
            </div>
        </div>
    </div>
      <div class="card">
        <strong>E – ENGAGE One Small Action</strong>
        <ul>
          <li>Be kind with yourself for one minute</li>
            <li>Before conversation: Forget about yourself completely for two minutes, and instead, try to discover one interesting detail about the other person. My only job is to listen. I don't have to be interesting. I just have to be interested.</li>
            <li>Before putting on the clothes: Wear the "imperfect" shirt deliberately. Your goal is not to look amazing. Your goal is to survive the day in a slightly imperfect outfit. At the end of the day, ask yourself: "Did anyone comment? Did my boss fire me? Did I die?" The answer will be no. You are gathering evidence that perfection is not required.</li>
          <li>Walk past the group—goal is to move.</li>
          <li>Post a simple story &nbsp;— &nbsp;survive being seen.</li>
        </ul>
      </div>
    </div>
    <div id="tab3" class="pane">
      <h1>Affirmations</h1>
      <p class="subtle">Click a category below to recall your truths.</p>
      
      <div class="card">
        <button class="collapsible">I know people will think I'm pathetic</button>
        <div class="collapsible-content"><div>
          <p>Wait. Let's be gentle here, both with me and with them.
            Right now, I am assuming I know exactly what is in their minds. But am I a mind reader? No. I am hurting myself with a story that I've invented.
            Let's look at the facts. They are not my jury; they are just people living their own lives, wrapped up in their own worries and thoughts. How much time did I spend today thinking about someone else's awkward moment? Probably zero. They don't care about me as much as my anxiety tells me they do. Their world doesn't revolve around me, and that is a relief. It's freedom.
            Did I notice someone sitting alone at lunch yesterday? Maybe. If I did, what did I think? Did I feel negative towards them? No. I probably thought, 'Oh, they're having a quiet lunch,' and then I immediately went back to worrying about my own life. That's just normal.
        </p>
            <p>And let's be kind to them, too. If they didn't invite me to do something fun, it's not a secret message that they hate me. It's a fact of busy lives. People forget. People get distracted. It doesn't mean I am disliked; it simply means I was not at the front of their mind in that moment. That's okay. If I want to be included, I can also take a small step to connect later.
            So right now, I will let go of the story I'm telling myself about them. I will focus on the only thing I can know for sure: my own intentions. My intention is to be kind. If being quiet and taking my time is my true self in this moment, then I will let it be. I will be here, as I am, without apology."
            
            </p>
        </div></div>
      </div>

      <div class="card">
        <button class="collapsible">I disappointed that important person</button>
        <div class="collapsible-content"><div>
          <p>I am listening for information about the task, not for a verdict on me. What is the specific problem that needs to be solved? What is the action that was done incorrectly?
            I'm learning and growing, and mistakes are part of that process
        </p>
            <p>If someone is loud or bitter to you: I wonder what is causing this strong reaction in them? They must be under a lot of stress. Perhaps they were treated this way and don't know another way to communicate. 
                Their harsh words say more about their stress/communication style than my worth.
               it's probably about their own stress and learned communication patterns. 
               
            </p>
        </div></div>
      </div>
    
      <div class="card">
        <button class="collapsible">I feel myself trying to hard for approval</button>
        <div class="collapsible-content"><div>
          <p>I see you, trying so hard to get it right. I see the effort you're putting in to be seen as competent and valuable. Let's take a moment and be gentle here.
            This feeling of pressure isn't a sign that you're failing; it's a sign that you care deeply. And that is a wonderful quality.
            But right now, let's let go of the need to impress. Impressing others is exhausting, and it's not where your true power lies. Your power isn't in a perfect performance; it's in your quiet competence. It's in the good work you do every single day.
            Your boss doesn't need a dazzling show. They need your thoughtful, reliable work. You've already earned your place here through your skills and your dedication, not through your ability to say the perfect thing in this one moment.
            So, let's shift the goal. The goal is not to impress.</p>
            <p>It's okay to be solid, steady, and quiet. It's okay to be you. Your best work comes from a place of calm, not from a place of pressure. Let's return to that calm now.</p>
        </div></div>
      </div>

      <div class="card">
        <button class="collapsible">I'm carefully crafting all the conversation
        </button>
        <div class="collapsible-content"><div>
          <p>Wait. This thought that just popped into my head—this is my authentic self trying to connect.
            Being in my head, planning the perfect sentence, is where the anxiety lives. Being in the conversation, sharing the first thing that comes to mind, is where the flow is. That is me being real.
            A conversation is not a performance. It doesn't need a script. It needs genuine contributions, even if they are imperfect. An awkward or simple contribution is better than the perfect contribution that never gets said.</p>
            <p>My goal is not to impress everyone. My goal is to add to the energy of the conversation. Sharing this thought is how I do that.
            I will trust my first thought. I will say it, even if my voice shakes a little. I am choosing to be present in this conversation, not a prisoner in my own mind</p>
        </div></div>
      </div>

      <div class="card">
        <button class="collapsible">I feel I'm so boring</button>
        <div class="collapsible-content"><div>
          <p>Thought: Am I actually that boring?</p>
          <p>Reality: Close friends tease each other - if they actually thought I was boring, would they hang out with me regularly?</p>
          <p>Evidence: What proof did they mean it?</p>
          <p>Kindness: I'm allowed to not be the funniest person in every group and still be valued for who I am</p>
        </div></div>
      </div>

      <div class="card">
        <button class="collapsible">I want some quiet lunch</button>
        <div class="collapsible-content"><div>
          <p>Thought: Everyone thinks I'm a loner</p>
          <p>Reality: People eat alone for many reasons - busy schedules, phone calls, needing quiet time, different lunch times.</p>
          <p>Evidence: When I see a coworker eating alone, do I think 'wow, they're so weird and friendless' or do I just mind my own business?</p>
          <p>Kindness: It's completely normal to have quiet moments. I'm allowed to have quiet moments and don't need to prove my social worth to colleagues during every lunch break</p>
        </div></div>
      </div>

      <div class="card">
        <button class="collapsible">Why I can't be like others...</button>
        <div class="collapsible-content"><div>
            <p>Wait. Let's remember who I really am.
                I know that person I was on my carefree day. I genuinely love her. She is not a stranger; she is me.
                On that day, I was happy. I was present. I was effortlessly kind to people, not because I was trying to perform, but because that's who I am when I'm not afraid. I deserve to feel that way more often. I deserve her.
                This anxiety, this fear of being boring or saying the wrong thing, is just a cloud passing in front of that person. It is not the sky.
                I know what will happen. Nothing will happen like I fear. The catastrophe I'm imagining is a phantom. It's a story I suffer from in my head, not in reality.
                And I know that people love authenticity. I do too. I love it when people are real, when they're a little awkward, when they're just... them. It gives me permission to be me. By being brave enough to be my authentic self right now—even if it's quiet, even if it's imperfect—I am giving someone else permission to be themselves too.
                So my goal right now is not to be perfect. It is to be authentic. I will be kind to myself, take one small step, and let the real me have a chance to show up.</p>
            <p>When you genuinely enjoy reading your Kindle alone at lunch, that's not something to fix or apologize for. That's you honoring what actually brings you peace and joy.
            There's this beautiful freedom in recognizing that your way of being social might look different from others, and that's completely valid. Some people recharge by being the loudest voice in group conversations. Others contribute through thoughtful listening, well-timed questions, or quiet presence. Both are valuable ways to connect.
            The key distinction is asking yourself: "Am I doing this because I want to, or because I'm afraid?" When you choose to read alone because you love that quiet time with a good book - that's self-respect. When you sit alone because you're convinced everyone will reject you - that's anxiety talking.
            
            
            Same with conversations. If you're naturally more of a listener who chimes in thoughtfully rather than dominating the discussion, that's your communication style. Some of the most magnetic people I know are the ones who make others feel heard rather than trying to be the entertainment.
            
            I am not a boring person; I am a person who has been afraid to share. I am now learning how to share, one small step at a time.
            
            Your preferences matter. Your way of moving through the world matters. You don't need to perform extroversion to prove your worth. The goal isn't to become someone else - it's to become more authentically yourself, whether that's quiet or loud, solitary or social, funny or thoughtful.
            Trust that inner voice that knows what actually feels good to you. It's usually wiser than the anxious voice telling you to fit in.
            </p></div></div>
          </div>
            
      <div class="card">
                <button class="collapsible">I'm afraid to share things</button>
                <div class="collapsible-content"><div>
                  <p>Sharing a piece of my life does not make me an attention-seeker; it makes me human.
                    I am allowed to take up space. I am allowed to share what brings me joy. I don't need to shrink myself to make others comfortable. If this feels true to who I am, then it's not fake.
                    I'm not performing for strangers—I'm documenting my life for me. I'd rather be seen as 'extra' than feel invisible.</p>
                    <p>The people who genuinely care about me want to see me happy and expressed. They will not be put off by my joy. Anyone who finds my joy 'obnoxious' is revealing something about themselves, not me.
                    So, right now, I am giving myself permission to be seen. I am sharing this because it brings me joy, and my joy is valid and worthy of being expressed.
                    </p>
                </div></div>
              </div>
            
        
    </div>
    <div id="tab4" class="pane">
      <h1>Challenge of the Day</h1>
      <p class="subtle">Pick your level, then hit “Shuffle” to get today’s mini-challenge.</p>
  
      <div class="card">
        <strong>Select Level:</strong>
        <div id="level-buttons">
          <button class="level-btn" data-level="1">Level 1</button>
          <button class="level-btn" data-level="2">Level 2</button>
          <button class="level-btn" data-level="3">Level 3</button>
        </div>
        <button class="btn" id="shuffle-btn" onclick="pickChallenge()">Shuffle Challenge</button>
      </div>
      
      
      <div id="challenge-display" class="card" style="min-height:4rem;">
        <!-- Your random challenge will appear here -->
      </div>

        <!-- Recent history of picks (move this above) -->
  <div class="card">
    <strong>Recent Challenges:</strong>
    <ul id="recent-challenges" style="margin-top:0.5rem; list-style:decimal inside;"></ul>
  </div>

  <!-- Toggle to view all challenges across Levels 1–3 -->
  <div class="card">
    <label>
      <input type="checkbox" id="view-all-toggle">
      View All Challenges (Levels 1–3)
    </label>
    <ul id="all-challenges-list" style="display:none; margin-top:0.5rem; list-style:disc inside;"></ul>
  </div>

    </div>
  <script>
    document.querySelectorAll('button.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('button.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.pane').forEach(p => p.classList.remove('active'));
        document.getElementById(btn.dataset.target).classList.add('active');
      });
    });
    // Self-Scan Logic
    const scanContainer = document.getElementById('scan-flow-container');
  const scanQuestions = [
    { part: 'Part 1: The Physical Scan', question: 'Where in my body am I feeling this discomfort right now?' },
    { part: 'Part 1: The Physical Scan', question: 'Did I sleep well? Do I need some rest?' },
    { part: 'Part 1: The Physical Scan', question: 'Have I had water in the last hour?' },
    { part: 'Part 1: The Physical Scan', question: 'Have I eaten in the last three hours?' },
    { part: 'Part 1: The Physical Scan', question: 'Can you just “be with” this feeling for three breaths? Do you feel calm now?', action: true },
    { part: 'Part 2: The Emotional Scan', question: 'Is there specific word that can capture this feeling? (embarrassed, left out, inadequate, angry)' },
    { part: 'Part 2: The Emotional Scan', question: 'If this feeling could speak, what  would it say?' },
    { part: 'Part 3: The Context Scan', question: 'What exact moment did this start in the last hour?' },
    { part: 'Part 4: The Core Inquiry', question: 'What does this situation remind me of?' },
    { part: 'Part 4: The Core Inquiry', question: 'What need is not being met? (Safety, Belonging, Competence, Authenticity)' },
    { part: 'Part 4: The Core Inquiry', question: 'If I treat myself with 100% kindness, what small act or phrase would I choose?' }
  ];
  let current = 0;
  const scanResponses = [];

  function render() {
    scanContainer.innerHTML = '';

    // 1) Show history
    scanResponses.forEach((ans, i) => {
      const hist = document.createElement('div');
      hist.className = 'question-card';
      hist.innerHTML = `
        <p><strong>Q${i+1}:</strong> ${scanQuestions[i].question}</p>
        <p><em>${ans}</em></p>
      `;
      scanContainer.appendChild(hist);
    });

    // 2) Completion view
    if (current >= scanQuestions.length) {
      scanContainer.innerHTML += `
        <div class="card">
          <h2>Inquiry Complete</h2>
          <p>Well done—acknowledging your experience is brave self-care.</p>
          <button class="btn" onclick="openExportViewer()">View & Export</button>
          <button class="btn" onclick="start()">Start Over</button>
        </div>`;
      return;
    }

    // 3) Next question
    const q = scanQuestions[current];
    const card = document.createElement('div');
    card.className = 'question-card';

    let inner = `
      <span class="step-indicator">${q.part}</span>
      <p><strong>${q.question}</strong></p>
    `;

    if (q.action) {
      // the three-breaths choice
      inner += `
        <label><input type="radio" name="breath" value="yes"> Yes – I can do it</label><br>
        <label><input type="radio" name="breath" value="no"> No – I need help</label><br>
        <button class="btn" onclick="handleBreath()">Continue</button>
      `;
    } else {
      // free-text response
      inner += `
        <textarea placeholder="Your answer..."></textarea>
        <button class="btn" onclick="next()">Next</button>
      `;
      if (current > 0) {
        inner += `
          <button
            class="btn"
            style="background: var(--secondary-color); color: var(--text-color); margin-top: 0.5rem;"
            onclick="prev()"
          >Back</button>
        `;
      }
    }

    card.innerHTML = inner;
    scanContainer.appendChild(card);

    const ta = card.querySelector('textarea');
    if (ta) ta.focus();
  }

  function handleBreath() {
    const choice = scanContainer.querySelector('input[name="breath"]:checked');
    if (!choice) return alert('Please choose Yes or No to continue.');
    scanResponses[current] =
      choice.value === 'yes'
        ? 'Yes – I can take three deep breaths with this feeling.'
        : 'No – I need to switch to panic relief.';
    if (choice.value === 'no') {
      document.querySelector('button.tab-btn[data-target="tab2"]').click();
    } else {
      current++;
      render();
    }
  }

  function next() {
    const ta = scanContainer.querySelector('textarea');
    scanResponses[current] = ta.value.trim();
    current++;
    render();
  }

  function prev() {
    if (current > 0) {
      current--;
      render();
    }
  }

  function start() {
    current = 0;
    scanResponses.length = 0;
    render();
  }

  // Opens a new styled window for export/print
  function openExportViewer() {
    let html = `
      <html><head>
      <title>Self-Scan Export</title>
      <style>
        body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; color: #333; }
        h1 { color: #8D6E63; text-align: center; }
        .qa { margin-bottom: 1.5rem; padding: 1rem; background: #fff;
              border-left: 5px solid #A1887F; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        .qa h2 { margin: 0 0 0.5rem; font-size: 1.1rem; color: #A1887F; }
        .qa p.answer { margin: 0; font-style: italic; }
        button { display: block; margin: 2rem auto 0; padding: 0.5rem 1rem;
                 background: #A1887F; color: #fff; border: none; border-radius: 4px;
                 cursor: pointer; font-size: 1rem; }
      </style>
      </head><body>
      <h1>Self-Scan Results</h1>
    `;
    scanResponses.forEach((ans, i) => {
      html += `
        <div class="qa">
          <h2>Q${i+1}: ${scanQuestions[i].question}</h2>
          <p class="answer">${ans}</p>
        </div>
      `;
    });
    html += `<button onclick="window.print()">Print</button>`;
    html += `</body></html>`;

    const w = window.open();
    w.document.write(html);
    w.document.close();
  }

  // initialize
  start();
    // Collapsible logic
    function initCollapsibles(root=document) {
      root.querySelectorAll('button.collapsible').forEach(btn => {
        btn.addEventListener('click', ()=>{
          btn.classList.toggle('active');
          const c = btn.nextElementSibling;
          if (c.style.maxHeight) { c.style.maxHeight = null; }
          else { c.style.maxHeight = c.scrollHeight + 'px'; }
        });
      });
    }
    initCollapsibles();
    const challenges = {
    1: [
      'Take a mindful 3-minute bathroom break — not to hide, but to ground.',
      'Wear no makeup today—what’s inside you matters more than any mask.',
      'Change the way you sit for comfort instead of “correct posture.”',
      'Take off your shoes under your desk for 5 minutes and just relax.',
      'Brush your hair, adjust your scarf, or stretch at your desk without rushing.',
      'Take a guilt-free power nap in your corner.',
      'Eat lunch without pretending to be busy.',
      'Wear one piece of clothing that makes YOU happy.'
    ],
    2: [
      'Smile at 3 people on your way to the bathroom or elevator.',
      'Say “Hi” with eye contact to someone you usually pass silently.',
      'Leave a short thank-you note or message.',
      'Think of at least one good thing about a person who usually makes you anxious.',
      'Absorb a conversation and note three interesting things about the other person.',
      'Tell someone “That looks cool / I like that / That’s a nice idea.”',
      'Speak at normal volume — enough for the other person to clearly hear.',
      'Post one thing that made you genuinely happy.',
      'Sit where you want to sit.',
      'Resist FOMO—turn off social notifications for today and be fully present.'
    ],
    3: [
      'Ask 1 person, “What are you working on today?”',
      'Don’t prepare any script before your meetings today—speak from the heart.',
      'Say “no thanks” to something — without over-explaining.',
      'When someone asks “how are you?” — give a real answer.',
      'Leave a gathering when you’re actually ready to leave.',
      'Get visibly excited about something you love (even if it’s “nerdy”).',
      'Say hello to someone you want to talk to.',
      'Join first in all meetings and greet others',
      'Ask for what you need.',
      'Correct or give honest feedback to someone kindly.',
      'Sing when you want to.'
    ]
  };

  const reminders = [
  'You can screenshot this challenge to remember to do this.',
  'You are more than ready to do this challenge!',
  'This challenge is your daily act of self-care—go for it!',
  'You’ve got this—one step at a time!',
  'Small actions lead to big changes—start now!',
  'Embrace the challenge—it’s a chance to grow!',
  'Theres no way you can fail this challenge.',
  'No matter how good you do this challenge, as long as you try.',
  'Give yourself a chance to do this challenge!',
  'Every step counts—you’re doing great!'
];


// track current level
let currentLevel = 1;
let recentHistory = [];


// initialize level buttons
document.querySelectorAll('.level-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentLevel = btn.dataset.level;
  });
});
// set Level 1 active by default
document.querySelector('.level-btn[data-level="1"]').classList.add('active');

function pickChallenge() {
  const list = challenges[currentLevel];
  const choice = list[Math.floor(Math.random() * list.length)];
  const reminder = reminders[Math.floor(Math.random() * reminders.length)];

  document.getElementById('challenge-display').innerHTML = `
    <span class="congrats">✨ Here’s today’s challenge:</span>
    <p class="challenge-text">${choice}</p>
    <p class="reminder">${reminder}</p>
    <button class="btn" onclick="pickChallenge()">Try Another</button>
  `;

  // record into recent history
  updateRecentHistory(choice);
}


// Update recent history UI
function updateRecentHistory(challenge) {
  recentHistory.unshift(challenge);
  if (recentHistory.length > 3) recentHistory.pop();
  const ul = document.getElementById('recent-challenges');
  ul.innerHTML = recentHistory.map(c => `<li>${c}</li>`).join('');
}

// Update "View All" list
// Show every challenge from Levels 1, 2 & 3
function updateAllList() {
  const all = [...challenges[1], ...challenges[2], ...challenges[3]];
  const ul = document.getElementById('all-challenges-list');
  ul.innerHTML = all.map(c => `<li>${c}</li>`).join('');
}

// Toggle checkbox handler (unchanged placement)
document.getElementById('view-all-toggle').addEventListener('change', e => {
  const ul = document.getElementById('all-challenges-list');
  if (e.target.checked) {
    updateAllList();
    ul.style.display = 'block';
  } else {
    ul.style.display = 'none';
  }
});



  </script>
</body>
</html>
